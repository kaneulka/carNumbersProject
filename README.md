# carNumbersProject
# Описание проекта

Проект разрабатывается для распознавания машин. Данная работа может помочь определить: входят ли приближающаяся машина в базу данных организации и вывести на экран информацио об владельце данного авто. При разработке можно выделить несколько этапов: подготовка и обработка данных, обучение модели, подготовка базы данных и тестовых изображений, установка необходимых компонентов и написание программы. В конце была проведена оценка проекта и описаны следующие шаги по доработке и усовершенствованию проекта. Использовалась версия Python 3.6.8, keras версии 2.2.4 и tensorflow ниже 2 версии.

## Подготовка и обработка данных
Изначально было скачано около 100 изображений. Каждое из этих изображений было обработа и выделены специальные обасти на фото с помощью ресурса **Roboflow**, где был расположен государственный номерной знак. Далее с помощью ресурсов сайта эти изображения были изменены (повернуты на определенное число градусов, использовалась инверсия в черно-белые цвета и т.д.), что дыло нам дополнительные наборы изображений. 

## Выбор и обучение модели
Выбор модели остановился на **YOLOv3**, благодаря ее долгому развитию и обширной поддержки в сообществе. Была сделана копия репозитория, подгружены даные и настроены все пораметры, после чего запустилось обучение предтренерованной модели. Вовремя обучения была подготовленна база данных с тествыми значнениями и программа для ее генерации **database.py**. К сожалению в процессе тестирования модели, подготовленная нами модель оказалась не совсем корректной в связи с малым числом изображений, поэтому была найдена и подключена уже готовая модель к нашему проекту.

## Установка дополнительных компонентов
Так как для выделения области в изображении используется код YOLOv3, потребовалось выбрать инструмент для считывания текста с изображения. Для этого было решено использовать **Tesseract**. 

## Написание кода программы
Текст самой программы был написан в файле **programm.py**. В нем используются:
1. доработаные методы обработки изображений YOLOv3;
2. подключение базы данных;
3. обрезка изображения для дальнешейго чтения в Tesseract;
4. получение текста непосредственно с обрезанного изображения;
5. поиск государственного номера в в тестовой базе данных;
6. вывод полученных результатов.

## Дальнейшие шаги по доработки проекта
На текущий момент даная программа не совсем корректно считывает текст с изображения. В связи с этим можно выделить несколько вариантов по исправлению:
1. Провести нормализацию изображения для возможности корректного считывания данных с изображения.
2. Проведение перетренировки модели с большим числом изображений для более коректного выделения номера изображения с конвертацией в нужную форму.
3. Выбор другого инструмента для упрожения считывания текста с изображения.

## Дальнейшие шаги по усовершенствованию проекта
Так как текущая версия программы обрабатывает только изображения находящиеся в папке, в дальнейшем есть возможность ее улучшить. Для этого можно будет преобразовать программу обработки не с картинки, а видеопотока. При этом добавив маску и подписав ее небходимыми данными, полученными из базы.

## Использованные ресурсы
1. Ссылка на подготовленный дата сет - https://app.roboflow.com/edu/car-numbers-8tl4j/1
2. Ссылка на репозиторий YOLOv3 для Windows - https://github.com/roboflow-ai/keras-yolo3
3. Ссылка на Colab файл по обучению модели - https://colab.research.google.com/drive/1ByRi9d6_Yzu0nrEKArmLMLuMaZjYfygO#scrollTo=4hBFndz8VeI6
4. Ссылка на обученную модель - https://drive.google.com/file/d/1cUimnMvj4cfVwf_F_SM9Qyznvb80XeIj/view?usp=share_link
~~Первоначальная модель: https://drive.google.com/file/d/1UEsQNRBv1H1K44DEuIcTfAtxtykpaS6n/view?usp=share_link)~~
5. Ссылка на репозиторий Tesseract - https://github.com/madmaze/pytesseract
6. Ссылка на инструкцию по обучению модели - https://docs.ultralytics.com/tutorials/train-custom-datasets/
